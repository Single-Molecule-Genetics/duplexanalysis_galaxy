<?xml version="1.0" encoding="UTF-8"?>
<!-- galaxy version 16.04 -->
<tool id="fsd" name="FSD" version="1.0.0">
    <description>: Family Size Distribution of duplex sequencing tags</description>
    <requirements>
        <requirement type="package" version="2.7">python</requirement>
        <requirement type="package" version="1.4.0">matplotlib</requirement>
    </requirements>
    
    <command>
        python2 '$__tool_directory__/fsd.py' --inputFile1 '${file1}' --inputName1 '${file1.name}' 
--inputFile2 '${file2}' --inputName2 '${file2.name}' --inputFile3 '${file3}' --inputName3 '${file3.name}' 
--inputFile4 '${file4}' --inputName4 '${file4.name}' $log_axis --output_pdf $output_pdf --output_tabular $output_tabular 
    </command>
    <inputs>
        <param name="file1" type="data" format="tabular" label="Dataset 1: input tags" optional="false"/>
        <param name="file2" type="data" format="tabular" label="Dataset 2: input tags" optional="true"  />
        <param name="file3" type="data" format="tabular" label="Dataset 3: input tags" optional="true" />
        <param name="file4" type="data" format="tabular" label="Dataset 4: input tags" optional="true"  help="Input in tabular format with the family size, tags and the direction of the strand ('ab' or 'ba') for each family. Name of the files can have max. 34 charcters!"/>
        <param name="log_axis" type="boolean" label="log scale for y axis?" truevalue="" falsevalue="--log_axis" checked="False" help="Transform y axis in log scale."/>
		
    </inputs>
    <outputs>
        <data name="output_pdf" format="pdf" />
        <data name="output_tabular" format="tabular"/>
    </outputs>
    <tests>
        <test>
            <param name="file1" value="fsd_data1.tab"/>
            <param name="file2" value="fsd_data2.tab"/>
            <param name="file3" value="fsd_data3.tab"/>
            <param name="file4" value="fsd_data4.tab"/>
            <output name="output_pdf" file="fsd_output1.pdf" lines_diff="285"/>
            <output name="output_tabular" file="fsd_output1.tab"/>
        </test>
        <test>
            <param name="file1" value="fsd_data1.tab"/>
            <param name="file2" value="fsd_data2.tab"/>
            <param name="file3" value="fsd_data3.tab"/>
            <output name="output_pdf" file="fsd_output2.pdf" lines_diff="285"/>
            <output name="output_tabular" file="fsd_output2.tab"/>
        </test>
    </tests>
    <help><![CDATA[

**What it does**
        
This tool will create a distribution of family sizes of each tag, which is separated after tags that have only the forward (ab) strand, the reverse (ba) strand or both strands (ab+ba) of the DCS and a family size distribution without separation is created. 
  
------             
        
**Input**
        
This tools expects a tabular file with the tags of all families, their sizes and information about forward (ab) and reverse (ba) strands:: 

      1  AAAAAAAAAAAATGTTGGAATCTT ba
     10  AAAAAAAAAAAGGCGGTCCACCCC ab
     28  AAAAAAAAAAATGGTATGGACCGA ab
          
**Output**
        
The output is a PDF file with the plot and a tabular file with the data of the plot.
        
**About Author**
        
Author: Monika Heinzl
Department: Institute of Bioinformatics, Johannes Kepler University Linz, Austria
Contact: monika.heinzl@edumail.at
        
]]> 
</help>
    <citations>
        <citation type="bibtex">
            @misc{duplex,
            author = {Heinzl, Monika},
            year = {2018},
            title = {Development of algorithms for the analysis of duplex sequencing data}
         }
        </citation>
    </citations>
</tool>
